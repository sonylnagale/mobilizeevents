<!DOCTYPE html>
<html>
<head>
  <title><%= title %></title>
  <link rel='stylesheet' href='/stylesheets/style.css' />
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
</head>
<body>
  <h1><%= title %></h1>

  <div id="tabs">
    <ul>
      <li><a href="#fragment-1">All Events</a></li>
      <li><a href="#fragment-2">Events Near Me</a></li>
      <li><a href="#fragment-3">Three</a></li>
    </ul>
    <div id="fragment-1">
      <h2>All events</h2>

      <p id="spinner"><img src="/images/Spinner.svg" width="100" height="100" /></p>
      <script id="all-events" type="text/x-handlebars-template">
        <div class="entry">
          {{#each events}}
          <h3><a class="event">Event ID {{id}}: {{name}}</a></h1>
          <div class="body">
            <p>{{description}}</p>
            <p>{{state}}</p>
            <p><div id="map_{{id}}" class="map"></div>
              <!-- time to get creative with a script inside handlebars -->
              <{{!}}script>
                var lat = {{lat}};
                var lng = {{lon}};
                var event_location = {lat: lat, lng: lng};
                map{{id}} = new google.maps.Map(document.getElementById("map_{{id}}"), {
                  zoom: 8,
                  center: event_location
                });
                var marker = new google.maps.Marker({
                  position: event_location,
                  map: map{{id}}
                });

                // custom event handler to retrigger google maps showing
                // due to dynamic creation and resizing
                $("#map_{{id}}").on('entryshow', function(e) {
                  var center = map{{id}}.getCenter();
                  google.maps.event.trigger(map{{id}}, "resize");
                  map{{id}}.setCenter(center);
                });
              <{{!}}/script>
            </p>
          </div>
          {{/each}}
        </div>
      </script>
    </div>
    <div id="fragment-2">
      <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
    </div>
    <div id="fragment-3">
      <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat.</p>
    </div>
  </div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.min.js"></script>
  <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBJrxMCxGyhMEM2_GiCxIyktYcUIcQjNWw">
  </script>
  <script src="/javascripts/main.js"></script>

</body>
</html>
